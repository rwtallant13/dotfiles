set vicmd=nvim

" Start in single pane mode by default
only

" Use vifm perform file operations instead of standard utilities like `cp`.
set syscalls

" The default is to move files that are deleted with dd or :d to the trash
""set trash

" This is how many directories to store in the directory history.
set history=10000

" Automatically resolve symbolic links on l or Enter.
set nofollowlinks

" With this option turned on you can run partially entered commands
" set fastrun

" Natural sort of (version) numbers within text.
set sortnumbers

" Maximum number of changes that can be undone.
set undolevels=100

" Use Vim's format of help file (has highlighting and "hyperlinks").
set novimhelp

" Hide ../
set dotdirs=

" nitems or size shown for directories
set dirsize=size

" Selected color scheme
colorscheme Default

" Time Format
set timefmt=%m/%d\ %H:%M

" Custom column layout
windo set viewcolumns=-10.5{size},-{name}..,12{atime}
""windo set viewcolumns=10{size},-{name}..,15{atime}

" Show list of matches on tab completion in command-line mode
set wildmenu

" Display completions in a form of popup with descriptions of the matches
set wildstyle=popup

" Display suggestions in normal, visual and view modes for keys, marks and
" registers (at most 5 files).  In other view, when available.
set suggestoptions=normal,visual,view,otherpane,keys,marks,registers

" Hide side borders
set tuioptions-=s

" ctrl - i/o cycle history
set cpoptions-=t

" Ignore case in search patterns unless it contains at least one uppercase
set ignorecase
set smartcase

" Don't highlight search results automatically
set nohlsearch

" Use increment searching (search while typing)
set incsearch

" Try to leave some space from cursor to upper/lower border in lists
set scrolloff=4

" Set custom status line look
set statusline="%A %8u:%-7g %5E %15d "

" slowfs for network drives
set slowfs+=rob@192.168.2.21:/data/


" ------------------------------------------------------------------------------
" bookmarks
" :mark mark /full/directory/path [filename]
mark h ~/
mark B /media/blueberry/backups/rob-pc/latest
mark M /media/blueberry/media/movies
mark s /media/blueberry/media/shows
mark m /media/blueberry/media
mark c /home/rob/.config
mark b /media/blueberry
mark d /home/rob/downloads
mark e /etc


" What should be saved automatically between vifm sessions.
set vifminfo=dhistory,chistory,tui,dirstack,registers,bookmarks

" my basic mappings
nnoremap <c-f> :fzf<cr>
nmap q ZZ
nmap ; :
nnoremap R :restart<cr>
nmap . za
map <delete> DD
map <C-h> <C-w>h
map <C-j> <C-w>j
map <C-k> <C-w>k
map <C-l> <C-w>l

" basics
nnoremap ? =
nnoremap | zR
nnoremap T :tree <cr>
nnoremap t tj
nnoremap ! :shell<cr>
nnoremap s :sort<cr>
nnoremap w :view<cr>
vnoremap w :view<cr>gv
nnoremap o :file &<cr>l

" Tabs
nnoremap <Insert> :tabnew<cr>
nnoremap <PageUp> :tabnext<cr>
nnoremap <PageDown> :tabprev<cr>


" invert sorting
map SS :invert o <cr>

"Custom split commands
map <C-h> <C-w>s
map <C-v> <C-w>v
map <C-s> <C-w>o


" remap increment number
noremap Q <C-a>
noremap A <C-x>

" select all
nnoremap <C-a> ggVG<cr>


" substitute in all files
nnoremap ca :%s/

" show background jobs
nnoremap J :jobs<cr>

" put in background
nnoremap P :put! &<cr>

" yank current directory path into the clipboard
nnoremap yd :!echo -n %d | xclip -selection clipboard %i<cr>:echo expand('%"d') "is yanked to clipboard"<cr>

" yank current file path into the clipboard
nnoremap yp :!echo -n %c:p | xclip -selection clipboard %i<cr>:echo expand('%"c:p') "is yanked to clipboard"<cr>

" yank current filename without path into the clipboard
nnoremap yn :!echo -n %c | xclip -selection clipboard %i<cr>:echo expand('%"c') "is yanked to clipboard"<cr>

" yank root of current file's name into the clipboard
nnoremap yr :!echo -n %c:r | xclip -selection clipboard %i<cr>:echo expand('%"c:r') "is yanked to clipboard"<cr>

" Mappings for faster renaming
nnoremap cc cw<c-u>

" Open terminal in current directory
nnoremap $ :!$TERMINAL %i &<cr>

" Open editor to edit vifmrc and apply settings after returning to vifm
nnoremap ,c :write | edit $MYVIFMRC | restart<cr>

" F keys remapping

nnoremap <F1> :!ndu <cr>
nnoremap <F2> cw
nnoremap <F3> :tree!<cr>
nnoremap <F4> :findfiles <cr>
nnoremap <F5> :history<cr>
nnoremap <F6> :marks<cr>


" Use rg instead of grep
set grepprg='rg %i %a %s'


" ------------------------------------------------------------------------------
" File Defaults

" :com[mand][!] command_name action
" The following macros can be used in a command
" %a is replaced with the user arguments.
" %c the current file under the cursor.
" %C the current file under the cursor in the other directory.
" %f the current selected file, or files.
" %F the current selected file, or files in the other directory.
" %b same as %f %F.
" %d the current directory name.
" %D the other window directory name.
" %m run the command in a menu window

command! df df -h %m 2> /dev/null
command! diff vim -d %f %F
command! zip zip -r %f.zip %f
command! run !! ./%f
command! make !!make %a
command! mkcd :mkdir %a | cd %a
command! vgrep vim "+grep %a"
command! reload :write | restart

command! fzfcd :set noquickview | :execute 'goto' fnameescape(term('fd . -H | fzf 2>/dev/tty'))

command! fzfhome :execute 'cd "'.system('fd -t d -H -a . $HOME ./ | fzf 2>/dev/tty').'"' | :redr

command! fzfind :set noquickview | :execute 'goto' fnameescape(term('fd . $HOME ./ -H -a | fzf  --height 10 --layout=default 2>/dev/tty'))

nnoremap <c-f> :fzfind<cr>
nnoremap <m-c> :fzfhome<cr>


command findfiles fd . -t f%u

" Open all other defaults
filetype * xdg-open %f 2>/dev/null 1>&2
