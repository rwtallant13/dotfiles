#
# ~/.aliases
#

# system
alias sudo='sudo '
alias udb='sudo updatedb'
alias last-backup='cat "$(ls -Art /media/blueberry/backups/rob-pc/rdiff-backup-data/session_statistics* | tail -n 1)"'
alias udev-reload='sudo udevadm control --reload-rules && sudo udevadm trigger'
alias timers='systemctl list-timers'
alias grub-update='sudo grub-mkconfig -o /boot/grub/grub.cfg'
alias dots='yadm'
alias dots-tracked='yadm list -a|less'
alias myip='curl http://ipecho.net/plain; echo'
alias S='sudo systemctl'
alias s='systemctl'
alias J='sudo journalctl'
alias rdb='rdiff-backup'

# pacman
alias pac='sudo pacman -S'
alias pacu='sudo pacman -Syu'
alias pacs='sudo pacman -Ss'
alias pacq='sudo pacman -Qs'
alias pacf='sudo pacman -F'
alias pacl='sudo pacman -Ql'
alias pacr='pacman -Rncs'
alias remove-orphans='sudo pacman -Rns $(pacman -Qtdq)'
alias pacrepo='sudo reflector -c US -c CA --protocol https --age 48 --sort score --save /etc/pacman.d/mirrorlist'

#python
alias pipi='pip install --user'

#ls
alias la='ls -hNa --color=auto --group-directories-first'
alias lla='ls -hlNa --color=auto --group-directories-first'
alias ll='ls -hlN --color=auto --group-directories-first'
alias ls='ls -hN --color=auto --group-directories-first'
alias lr='ls -RhN --color=auto --group-directories-first'
alias lb='ls -hN --color=auto --group-directories-first /home/rob/.bin/'

# commands
alias bb='ssh bb'
alias df='df -h'
alias cmd='compgen -c | fzf'
alias rm='rm -I'
alias grep='grep --color=auto'
alias gt='gotop'
alias gcp='g++'
alias hb='HandBrakeCLI'
alias hist='history'
alias iftop='sudo iftop -b'
alias mclog='ssh bb journalctl -f -u minecraft@vanilla.service'
alias mcctrl='ssh -t bb /home/rob/bin/mcctrl'
alias m='micro'
alias n='nnf'
alias ndu='nnn -S'
alias bandwhich='sudo bandwhich'
alias cpu-speed=' watch -n.1 "cat /proc/cpuinfo | grep \"^[c]pu MHz\""'
alias pb='curl -F "f:1=<-" ix.io'
alias pf='pfetch && colorpanes'
alias pilog='ssh -t pi pihole -t'
alias rmr='rm -rf'
alias rf='rg --files --hidden'
alias tb='nc termbin.com 9999'
alias v='/home/rob/.bin/nv'
alias vf='vifm'
alias vfm='vifm /media/blueberry/media'
alias wcl='wc -l'
alias yta='youtube-dl -x --audio-format mp3'
alias xc='xclip -selection clipboard'
alias zz='z -c'
alias zi='z -i'
alias zf='z -I'
alias zb='z -b'


#
# functions
#

fzcd() {
	$(__fzf_cd__)
}

kw(){
    nohup kwrite "$@" & disown
    }

pkglist(){
    pacman -Qqne > /home/rob/docs/pacman-pkgs
    pacman -Qqme > /home/rob/docs/yay-pkgs

    pacman -Qq | fzf --height=100% --preview 'pacman -Qi {}' --layout=reverse
    }

mkcd(){
	mkdir -p "$1" && cd "$1"
}

chx(){
    chmod +x $1
}


se(){
    dir="${@:-"."}"
    sel="$(fd . -H "$dir"| fzf)"
    if [[ -d "$sel" ]] ; then
        cd "$sel"
    elif [[ -f "$sel" ]]; then
        /home/rob/.bin/nv "$sel"
    fi
    }

swap()
{
    local TMPFILE=tmp.$$
    mv "$1" $TMPFILE && mv "$2" "$1" && mv $TMPFILE "$2"
}

open(){
    nohup xdg-open "$@" >/dev/null 2>&1 & disown
    }

timeof(){
    local pid

    pid=$(ps -e -o pid,user,cmd | sed 1d | fzf -m | awk '{print $1}')

    if [ "x$pid" != "x" ]
    then
        ps -p "$pid" -o etime,command
    fi
    }

cpf(){
    if [[ $1 ]]; then
        cat "$1" | xclip -selection clipboard
    else
        echo 'file required'
        exit 0
    fi

    }

vlc-yt(){
    vlc "$(youtube-dl --get-url --format best $1)"
    }

hist_dedup() {

    tac ~/.config/bash_history | awk '! x[$0]++' | tac > ~/bash_hist_clean ;

    mv ~/.config/bash_history ~/.config/bash_history_old ;

    mv ~/bash_hist_clean ~/.config/bash_history ;

    }

fv() {
	local file
    dir="${1:-"."}"
	file="$( fd . $dir --hidden -t f -i | fzf -m -e -0 -1)"

	if [[ -n $file ]]
	then
		v "$file"
	fi
    }

fkill() {
    local pid

    pid=$(ps -eo user,pid,etime,cmd | sed 1d | fzf -m | awk '{print $2}')

    if [ "x$pid" != "x" ]
    then
        echo $pid | xargs sudo kill -${1:-9}
    fi
    }

fzaux() {
    local pid
    if [ "$UID" != "0" ]; then
        ps -f -u $UID | sed 1d | fzf -m
    else
        ps -ef | sed 1d | fzf -m
    fi
}

fman() {
    man -k . | fzf --prompt='Man> ' | awk '{print $1}' | xargs -r man
}

pman() {
     man -Tpdf "$1" | zathura - >/dev/null 2>&1 & disown
    }

fdchars() {
    fd -H $* | grep -E '\s|\*|\?|\$|%|'\ ''

}
